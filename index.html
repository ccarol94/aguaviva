function doPost(e) {
  try {
    // Verifica se os dados foram recebidos
    if (!e || !e.postData || !e.postData.contents) {
      throw new Error("Dados n√£o recebidos.");
    }

    // Parseia os dados recebidos
    const data = JSON.parse(e.postData.contents);

    // Valida os dados
    if (!data.latitude || !data.longitude || !data.timestamp) {
      throw new Error("Dados incompletos.");
    }

    const latitude = data.latitude;
    const longitude = data.longitude;
    const timestamp = data.timestamp;

    // Abre a planilha e adiciona os dados
    const sheet = SpreadsheetApp.openById("12oI_GxB5vbvhifCahn5fGI1U40FPL9Jb2itdGwjZOMA").getActiveSheet();
    sheet.appendRow([timestamp, latitude, longitude]);

    // Retorna uma resposta de sucesso
    return ContentService.createTextOutput(JSON.stringify({ 
      status: "success", 
      message: "Dados salvos com sucesso!" 
    }))
      .setMimeType(ContentService.MimeType.JSON)
      .addHeader("Access-Control-Allow-Origin", "*"); // Permite CORS
  } catch (error) {
    // Retorna uma resposta de erro
    return ContentService.createTextOutput(JSON.stringify({ 
      status: "error", 
      message: error.toString() 
    }))
      .setMimeType(ContentService.MimeType.JSON)
      .addHeader("Access-Control-Allow-Origin", "*"); // Permite CORS
  }
}
